# golang-ships-parser

Небольшой CLI-парсер, который читает список ссылок из Excel, по каждой ссылке ищет судно на **vesselfinder.com** и сохраняет итоговую таблицу в Excel и CSV.

## Требования

- Go (совместимо с версией из `go.mod`)
- Доступ в интернет (выполняются HTTP-запросы к `https://www.vesselfinder.com`)

## Быстрый старт

1) Положите рядом с исполняемым файлом (в корень проекта) входной файл `Links.xlsx`.

2) Запустите:

```bash
go run ./cmd/app
```

Или соберите бинарник:

```bash
go build -o ships-parser ./cmd/app
./ships-parser
```

После завершения появятся файлы:

- `result.xlsx`
- `result.csv`

## Формат входного Excel

Программа читает файл `Links.xlsx` (имя задано в `pkg/cfg/cfg.go`).

- Лист: `Лист1`
- Ссылки берутся из **первой колонки (A)**
- **Первая строка считается заголовком** и пропускается

Пример:

| URL |
| --- |
| https://www.vesselfinder.com/ru/ships/details/… |
| https://www.vesselfinder.com/ru/ships/details/… |

## Формат результатов

Результаты сохраняются в `result.xlsx` и `result.csv` со столбцами:

- `Название`
- `IMO`
- `MMSI`
- `Тип`
- `Ссылка` (исходная ссылка из `Links.xlsx`)
- `Ошибка` (если по конкретной ссылке не удалось получить данные)

## Примечания

- Между запросами делается пауза `500ms` (см. `pkg/cfg/cfg.go`).
- Можно остановить выполнение `Ctrl+C` — уже собранные результаты будут сохранены.

## Структура проекта

- `cmd/app` — точка входа
- `internal/app` — orchestration (чтение ссылок → парсинг → сохранение)
- `internal/reader` — чтение Excel (`Links.xlsx`)
- `internal/parser` — HTTP + парсинг HTML (goquery)
- `internal/saver` — сохранение результата в Excel/CSV
- `pkg/cfg` — константы (имена файлов, селекторы, таймауты)
